import pandas as pd
df = pd.read_csv("train_1.csv")

# ğŸ“Œ 1. Ğ’Ñ–Ğ´ÑĞ¾Ñ€Ñ‚ÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ¿Ğ¾ Ğ·Ñ€Ğ¾ÑÑ‚Ğ°Ğ½Ğ½Ñ (ascending) Ñ– ÑĞ¿Ğ°Ğ´Ğ°Ğ½Ğ½Ñ (descending)
df_sorted_asc = df.sort_values(by="Sales", ascending=True)  # ĞŸĞ¾ Ğ·Ñ€Ğ¾ÑÑ‚Ğ°Ğ½Ğ½Ñ
df_sorted_desc = df.sort_values(by="Sales", ascending=False)  # ĞŸĞ¾ ÑĞ¿Ğ°Ğ´Ğ°Ğ½Ğ½Ñ

print("ğŸ”¹ Ğ’Ñ–Ğ´ÑĞ¾Ñ€Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¿Ğ¾ Ğ·Ñ€Ğ¾ÑÑ‚Ğ°Ğ½Ğ½Ñ:\n", df_sorted_asc.head())
print("ğŸ”¹ Ğ’Ñ–Ğ´ÑĞ¾Ñ€Ñ‚Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¿Ğ¾ ÑĞ¿Ğ°Ğ´Ğ°Ğ½Ğ½Ñ:\n", df_sorted_desc.head())

# ğŸ“Œ 2. Ğ“Ñ€ÑƒĞ¿ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ¿Ğ¾ Ğ¾Ğ´Ğ½Ñ–Ğ¹ ĞºĞ¾Ğ»Ğ¾Ğ½Ñ†Ñ– (Ğ·Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¶ĞµĞ½Ğ½Ñ max Sales Ğ¿Ğ¾ ĞºĞ¾Ğ¶Ğ½Ğ¾Ğ¼Ñƒ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ñƒ)
grouped_one = df.groupby("Store")["Sales"].max()
print("ğŸ”¹ ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ– Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ¿Ğ¾ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ°Ñ…:\n", grouped_one.head())

# ğŸ“Œ 3. Ğ“Ñ€ÑƒĞ¿ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ¿Ğ¾ Ğ´Ğ²Ğ¾Ñ… ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ°Ñ… (Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ– Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ¿Ğ¾ ĞºĞ¾Ğ¶Ğ½Ğ¾Ğ¼Ñƒ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ñƒ Ğ·Ğ° ĞºĞ¾Ğ¶ĞµĞ½ Ğ´ĞµĞ½ÑŒ Ñ‚Ğ¸Ğ¶Ğ½Ñ)
grouped_two = df.groupby(["Store", "DayOfWeek"])["Sales"].max()
print("ğŸ”¹ ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ– Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ¿Ğ¾ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ°Ñ… Ñ– Ğ´Ğ½ÑÑ… Ñ‚Ğ¸Ğ¶Ğ½Ñ:\n", grouped_two.head())

# ğŸ“Œ 4. Ğ“Ñ€ÑƒĞ¿ÑƒĞ²Ğ°Ğ½Ğ½Ñ Ğ¿Ğ¾ Ñ‚Ñ€ÑŒĞ¾Ñ… ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ°Ñ… (Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ– Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ· ÑƒÑ€Ğ°Ñ…ÑƒĞ²Ğ°Ğ½Ğ½ÑĞ¼ Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ñ‚Ñ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ñƒ)
grouped_three = df.groupby(["Store", "DayOfWeek", "Open"])["Sales"].max()
print("ğŸ”¹ ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ– Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ· ÑƒÑ€Ğ°Ñ…ÑƒĞ²Ğ°Ğ½Ğ½ÑĞ¼ Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ñ‚Ñ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ñƒ:\n", grouped_three.head())

# ğŸ“Œ 5. ĞĞ³Ñ€ĞµĞ³Ğ°Ñ†Ñ–Ñ Ğ´Ğ°Ğ½Ğ¸Ñ… (agg) - ÑĞµÑ€ĞµĞ´Ğ½Ñ– Ñ‚Ğ° Ğ¼Ğ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ– Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ¿Ğ¾ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ°Ñ…
agg_sales = df.groupby("Store").agg({"Sales": ["mean", "max"], "Customers": "sum"})
print("ğŸ”¹ ĞĞ³Ñ€ĞµĞ³Ğ°Ñ†Ñ–Ñ Ğ´Ğ°Ğ½Ğ¸Ñ… (ÑĞµÑ€ĞµĞ´Ğ½Ñ– Ñ‚Ğ° Ğ¼Ğ°ĞºÑ. Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ–, ÑÑƒĞ¼Ğ° Ğ¿Ğ¾ĞºÑƒĞ¿Ñ†Ñ–Ğ²):\n", agg_sales.head())

# ğŸ“Œ 6. Ğ¤Ñ–Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ñ–Ñ Ğ¿Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ (Ğ½Ğ°Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´, Ğ²Ğ¸Ğ±Ñ€Ğ°Ñ‚Ğ¸ Ğ²ÑÑ– Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¸, Ğ´Ğµ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– Ğ±Ñ–Ğ»ÑŒÑˆĞµ 5000)
filtered_sales = df[df["Sales"] > 5000]
print("ğŸ”¹ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¸ Ğ· Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ°Ğ¼Ğ¸ Ğ±Ñ–Ğ»ÑŒÑˆĞµ 5000:\n", filtered_sales.head())

# ğŸ“Œ 7. ĞÑ‚Ñ€Ğ¸Ğ¼Ğ°Ñ‚Ğ¸ Ñ€ÑĞ´ĞºĞ¸ Ğ· Ğ¿ĞµĞ²Ğ½Ğ¸Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½ÑĞ¼ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñƒ (Ğ½Ğ°Ğ¿Ñ€Ğ¸ĞºĞ»Ğ°Ğ´, Ğ²ÑÑ– Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¸, ÑĞºÑ– Ğ·Ğ°ĞºÑ€Ğ¸Ñ‚Ñ–)
closed_stores = df[df["Open"] == 0]
print("ğŸ”¹ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¸, ÑĞºÑ– Ğ·Ğ°ĞºÑ€Ğ¸Ñ‚Ñ–:\n", closed_stores.head())

# ğŸ“Œ 8. ĞĞ°Ğ¿Ğ¸ÑĞ°Ñ‚Ğ¸ Ğ´Ğ¾Ğ²Ñ–Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ·Ğ°Ğ¿Ğ¸Ñ‚ (query)
query_result = df.query("Sales > 5000 and Customers > 1000")  # ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¸, Ğ´Ğµ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ– >5000 Ñ– Ğ¿Ğ¾ĞºÑƒĞ¿Ñ†Ñ–Ğ² >1000
print("ğŸ”¹ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ğ¸ Ğ· Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ°Ğ¼Ğ¸ >5000 Ñ– Ğ¿Ğ¾ĞºÑƒĞ¿Ñ†ÑĞ¼Ğ¸ >1000:\n", query_result.head())
